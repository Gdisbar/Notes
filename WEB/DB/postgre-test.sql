-- CREATE SCHEMA IF NOT EXISTS ChatDB;

-- CREATE TABLE ChatDB.ChatData (
--     chat_id INTEGER, -- Renamed from object_id, not a primary key
--     user_name VARCHAR(100) NOT NULL, -- User name with a maximum length of 100 characters
--     user_query TEXT NOT NULL, -- User query with no length limitation
--     bot_response TEXT NOT NULL, -- Bot response with no length limitation
--     session_status VARCHAR(50) NOT NULL -- Session status with a maximum length of 50 characters
-- );


-- INSERT INTO ChatDB.ChatData (chat_id, user_name, user_query, bot_response, session_status)
-- VALUES
--     (1, 'Alice', 'What is the weather today?', 'It is sunny and 25°C.', 'active'),
--     (2, 'Bob', 'Tell me a joke.', 'Why don’t skeletons fight each other? They don’t have the guts!', 'active'),
--     (3, 'Charlie', 'How do I reset my password?', 'Click on "Forgot Password" and follow the instructions.', 'resolved'),
--     (4, 'Diana', 'What is 2 + 2?', '2 + 2 equals 4.', 'active'),
--     (5, 'Eve', 'End the session.', 'Session has been ended. Thank you!', 'closed');

-- SELECT * FROM ChatDB.ChatData;

-- CREATE TABLE ChatDB.ChatData_Vector (
--     chat_id SERIAL PRIMARY KEY,
--     combined_query_response TEXT,
--     vector_embedding VECTOR(300)  -- Adjust the vector size based on your model's output
-- );

-- CREATE INDEX ON ChatDB.ChatData_Vector USING ivfflat (vector_embedding);



SELECT chat_id, combined_query_response
FROM ChatDB.ChatData_Vector
WHERE vector_embedding <-> ARRAY[
    0.07698948, -0.016967792, -0.05644045, 0.0124524, 0.052533247, 0.01632999, 
    0.0077351527, -0.014214642, 0.04659523, -0.00064491574, 0.055234645, 0.01242316, 
    0.035051793, -0.015766278, -0.027610257, -0.009547527, 0.0065581976, -0.06261815, 
    0.015236557, -0.023702264, 0.006677767, -0.009204446, -0.017050099, -0.031474456, 
    -0.009241421, 0.008788494, 0.0301582, 0.0044138785, -0.028776469, -0.0819441, 
    -0.019948099, -0.005072836, -0.0019200938, 0.007916985, -0.08421743, -0.06741154, 
    0.020984083, 0.056649387, -0.03166371, -0.017575348, -0.011757514, 0.04052344, 
    -0.00084300106, -0.05342611, 0.008211618, 0.058446597, 0.018768061, 0.034466647, 
    0.05167817, -0.010140002, 0.0672503, -0.009550438, -0.0015391391, -0.019164372, 
    0.040946573, -0.032325696, 0.03376933, -0.026081715, -0.021099538, 0.028000627, 
    0.045753423, -0.024823494, 0.024428232, 0.018444803, 0.0501991, 0.049754266, 
    -0.00472703, 0.09920655, -0.034429293, -0.011340175, 0.008941575, -0.030093908, 
    0.057664454, 0.057705224, 0.030330436, -0.009225833, 0.07630034, 0.03195616, 
    -0.0575209, -0.021364514, -0.047484003, 0.018008713, 0.052674815, 0.08458283, 
    0.031282064, -0.044758555, 0.04749307, -0.033367608, -0.003698282, 0.004634506, 
    0.027470665, 0.011588711, -0.044599492, -0.05790246, 0.028146327, 0.009718872, 
    0.056025717, 0.05314195, 0.086289, -0.034067124, 0.036246106, 0.030607691, 
    0.0030133314, -0.05182046, 0.01564721, -0.051060963, -0.045174837, 0.0050810017, 
    0.026356071, 0.018419681, -0.038740568, 0.025306715, -0.03679713, -0.036860194, 
    0.04201368, 0.037831225, 0.04448042, 0.012913427, -0.011676477, 0.024456117, 
    -0.08923269, 0.09677449, 0.01657097, -0.0692394, 0.06965145, 0.02568698, 
    -0.06516185, 0.06768393, 0.022975843, -0.07568044, 0.026806405, -0.044252463, 
    0.051064774, 0.038590565, -0.0029063094, -0.03902371, 0.019138537, -0.024178438, 
    0.062346265, 0.07383561, -0.009509018, 0.013314248, -0.0029514441, 0.052059922, 
    0.0077529447, -0.029463375, -0.036583584, -0.028309327, -0.04906191, -0.026897319, 
    -0.024185035, -0.034900807, -0.051474705, -0.006311815, -0.0011479259, 
    -0.021533709, -0.079983935, -0.008685182, -0.020334829, -0.00021524332, 
    -0.021275751, -0.031584684, -0.07756028, 0.021920908, 0.016950704, 0.05671163, 
    0.0047415528, 0.015863188, 0.032082275, 0.0309555, 0.06537934, -0.039762497, 
    0.062121816, 0.07818534, -0.045786202, -0.080979094, -0.0295473, 0.044403125, 
    0.025717506, -0.007547266, 0.016035689, 0.03408964, 0.034595076, 0.05225914, 
    -0.031070441, -0.014112762, 0.035547562, -0.06276266, 0.006719451, -0.036279194, 
    0.044177078, 0.045417015, 0.094168484, -0.03299177, 0.10135877, 0.10788705, 
    -0.07041688, 0.03411992, 0.04369834, 0.0095061725, -0.012806097, 0.0446707, 
    0.00712484, 0.04481015, 0.0843509, -0.051713202, -0.011116881, -0.0021014432, 
    -0.118807524, 0.06633335, 0.0049413205, 0.014794976, 0.0029319674, 0.058679387, 
    -0.012208361, 0.0017356612, 0.052715007, -0.033875227, -0.031933963, 0.014080694, 
    -0.008284424, -0.014202872, 0.038302816, 9.911996e-05, 0.006076999, -0.069810174, 
    0.023124255, -0.023730492, 0.037816975, 0.031571954, 0.059601888, -0.05500338, 
    -0.042255126, -0.04895016, 0.0031152712, 0.029146159, -0.014220669, 0.049116623, 
    -0.0034652557, -0.05136163, -0.0011386052, 0.0011734087, -0.06622672, 0.05287169, 
    -0.00591632, -0.04637041, 0.016509973, -0.051565364, 0.024791894, 0.0024891915, 
    0.005028786, 0.053489152, -0.031396534, -0.057629887, -0.03595904, 0.039180662, 
    0.012397565, -0.027450196, 0.008025028, 0.037851058, -0.029893689, 0.028944558, 
    0.037861504, -0.02175857, 0.0730378, 0.054719217, -0.066590875, -0.008796034, 
    -0.05752273, 0.06785893, 0.003165003, 0.00957771, 0.039953608, 0.031748265, 
    -0.04631068, -0.02308574, -0.002954572, -0.00885075, 0.011126474, 0.032627888, 
    0.0069023557, -0.012620527, -0.061241027, 0.01630893, 0.011083845, -0.10626156, 
    0.05412298, 0.02335126, 0.04862529, 0.104832724, -0.007531889, -0.046464153, 
    -0.06316813, -0.04641054, -0.006275071, 0.0041270787, 0.097278565, 0.0041854214, 
    0.071426384, 0.0020
]::vector < 0.7
ORDER BY chat_id;


